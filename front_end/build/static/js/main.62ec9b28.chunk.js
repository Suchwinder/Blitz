(this.webpackJsonpfront_end=this.webpackJsonpfront_end||[]).push([[0],{168:function(e,t,a){},170:function(e,t,a){},183:function(e,t,a){},184:function(e,t,a){},216:function(e,t){},227:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(15),s=a.n(i),l=a(36),o=a(37),c=a(42),u=a(40),m=a(44),d=a(145),p=a(97),_=a(16),h=a(278),f=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),i=a[0],s=a[1];return Object(n.useEffect)((function(){s("")}),[i]),"main"===i?r.a.createElement(_.a,{to:"/"}):"create"===i?r.a.createElement(_.a,{to:"/create_group"}):"join"===i?r.a.createElement(_.a,{to:"/join_group"}):r.a.createElement("header",null,r.a.createElement(p.a,{bg:"dark",variant:"dark"},r.a.createElement(p.a.Brand,{onClick:function(){return s("main")}},"Blitz"),r.a.createElement(d.a,{className:"ml-auto"},r.a.createElement(h.a,{className:"button",variant:"dark",onClick:function(){return s("main")}}," ","Home"," "),r.a.createElement(h.a,{variant:"dark",onClick:function(){return s("create")}}," ","Create"," "),r.a.createElement(h.a,{variant:"dark",onClick:function(){return s("join")}}," ","Join"," "))))},g=(a(168),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(f,null),r.a.createElement("div",{className:"text"},r.a.createElement("h1",null,"What do we do?"),r.a.createElement("p",null,"We help people split the bill."),r.a.createElement("h2",null,"How it works:"),r.a.createElement("ol",null,r.a.createElement("li",null,"Create a group")," ",r.a.createElement("li",null,"Enter Parameters (enter number of people)")," ",r.a.createElement("li",null,"Upload the receipt and share your group's link")," ",r.a.createElement("li",null,"Each individual selects their purchase(s)")," ",r.a.createElement("li",null,"That's it")," ")," "))}}]),a}(n.Component)),b=a(12),E=a.n(b),v=a(21),w=a(56),k=a(18),C=(a(170),a(22)),x=a(142),j=a(144),y=a(275),O=a(276),S=a(141),A=a.n(S),I=a(271),N=a(228),U=a(262),T=a(134),R=a.n(T),P=a(135),L=a.n(P);var D=Object(U.a)((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}}));function F(e){var t=D(),a=r.a.useState(null),n=Object(m.a)(a,2),i=n[0],s=n[1],l=r.a.useState(""),o=Object(m.a)(l,2),c=o[0],u=o[1],d=r.a.useState([]),p=Object(m.a)(d,2),_=p[0],h=p[1],f=r.a.useRef(!1),g=r.a.useRef(),b=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_KEY;"undefined"===typeof window||f.current||(document.querySelector("#google-maps")||function(e,t,a){if(t){var n=document.createElement("script");n.setAttribute("async",""),n.setAttribute("id",a),n.src=e,t.appendChild(n)}}("https://maps.googleapis.com/maps/api/js?key="+b+"&libraries=places",document.querySelector("head"),"google-maps"),f.current=!0);var E=r.a.useMemo((function(){return L()((function(e,t){g.current.getPlacePredictions(e,t)}),200)}),[g]);return r.a.useEffect((function(){var e=!0;if(!g.current&&window.google&&(g.current=new window.google.maps.places.AutocompleteService),g.current){if(""!==c)return E({input:c,types:["address"]},(function(t){if(e){var a=[];i&&(a=[i]),t&&(a=[].concat(Object(w.a)(a),Object(w.a)(t))),h(a)}})),function(){e=!1};h(i?[i]:[])}}),[i,c,E,e]),r.a.createElement(O.a,{id:"google-map-demo",getOptionLabel:function(e){return"string"===typeof e?e:e.description},filterOptions:function(e){return e},options:_,autoComplete:!0,includeInputInList:!0,filterSelectedOptions:!0,value:i,onChange:function(t,a){h(a?[a].concat(Object(w.a)(_)):_),s(a),e.handleParentFunc(a.description)},onInputChange:function(e,t){u(t)},renderInput:function(e){return r.a.createElement(y.a,Object.assign({},e,{label:"Add a location",variant:"filled",fullWidth:!0}))},renderOption:function(e){var a=e.structured_formatting.main_text_matched_substrings,n=R()(e.structured_formatting.main_text,a.map((function(e){return[e.offset,e.offset+e.length]})));return r.a.createElement(I.a,{container:!0,alignItems:"center"},r.a.createElement(I.a,{item:!0},r.a.createElement(A.a,{className:t.icon})),r.a.createElement(I.a,{item:!0,xs:!0},n.map((function(e,t){return r.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),r.a.createElement(N.a,{variant:"body2",color:"textSecondary"},e.structured_formatting.secondary_text)))}})}var G=a(279),B=a(280),J=a(269),z=a(272),W=a(79),H=a.n(W),V=(a(113),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState(Object(k.a)({},e.target.name,e.target.value))},n.handleImage=function(e){var t=URL.createObjectURL(e.target.files[0]),a=new Blob([e.target.files[0]]);n.setState({file:a,preview:t})},n.onImageLoaded=function(e){n.imageRef=e,n.setState({newFile:n.imageRef})},n.onCropComplete=function(e){n.makeClientCrop(e)},n.onCropChange=function(e){n.setState({crop:e})},n.handleUsers=function(e,t,a){if("remove-option"===a)n.setState({input_users:t});else{if("create-option"!==a)return;var r=!1;if(n.state.input_users.map((function(t){return t===e.target.value?(r=!0,alert("Duplicate User Cannot Exist")):null})),r)return;n.setState({input_users:[].concat(Object(w.a)(n.state.input_users),[e.target.value])})}},n.handleSubmit=function(){var e=Object(v.a)(E.a.mark((function e(t){var a,r,i,s,l,o,c,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""===n.state.preview){e.next=17;break}return(a=new FormData).append("file",n.state.newFile),e.next=6,fetch("/api/upload_image",{method:"POST",body:a});case 6:return r=e.sent,i=r.status,e.next=10,r.json();case 10:if(s=e.sent,200!==i){e.next=15;break}n.setState({image_s3url:s.message}),e.next=17;break;case 15:return console.log(s.error),e.abrupt("return");case 17:return l={users:n.state.input_users,street_address:n.state.input_address,location_name:n.state.input_location,city:n.state.input_city,state:n.state.input_state,zip_code:n.state.input_zip_code,image_s3url:n.state.image_s3url,tip_rate:n.state.input_tip},e.prev=18,e.next=21,fetch("/api/create_group",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify(l)});case 21:return o=e.sent,c=o.status,e.next=25,o.json();case 25:u=e.sent,200===c?n.setState({group_url:u.link,redirect:!0}):alert(u.error),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(18),console.log(e.t0);case 32:case"end":return e.stop()}}),e,null,[[18,29]])})));return function(t){return e.apply(this,arguments)}}(),n.handleParentFunc=function(e){if(e){var t=e.split(","),a=Object(m.a)(t,4),r=a[0],i=a[1],s=a[2],l=a[3];r&&i&&s&&l&&n.setState({input_address:r,input_zip_code:l,input_city:i,input_state:s})}},n.state={file:null,preview:"",newFile:"",input_users:[],input_address:"",input_zip_code:"",input_city:"",input_state:"",input_tip:0,input_location:"",redirect:!1,group_url:"",image_s3url:"",crop:{unit:"%",width:100,height:100},croppedImageUrl:""},n.inputFileRef=r.a.createRef(),n}return Object(o.a)(a,[{key:"makeClientCrop",value:function(){var e=Object(v.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.imageRef&&t.width&&t.height)){e.next=5;break}return e.next=3,this.getCroppedImg(this.imageRef,t,"newFile.jpeg");case 3:a=e.sent,this.setState({croppedImageUrl:a});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCroppedImg",value:function(e,t,a){var n=this,r=document.createElement("canvas"),i=e.naturalWidth/e.width,s=e.naturalHeight/e.height;return r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(e,t.x*i,t.y*s,t.width*i,t.height*s,0,0,t.width,t.height),new Promise((function(e,t){r.toBlob((function(t){t?(window.URL.revokeObjectURL(n.fileUrl),n.fileUrl=window.URL.createObjectURL(t),e(n.fileUrl),n.setState({newFile:t})):console.error("Canvas is empty")}))}))}},{key:"render",value:function(){var e=this;return this.state.redirect?r.a.createElement(_.a,{to:this.state.group_url}):r.a.createElement(j.a,{onSubmit:this.handleSubmit,initialValues:{input_users:"",input_address:""}},(function(t){t.handleSubmit,t.handleChange,t.handleBlur;return r.a.createElement("div",null,r.a.createElement(f,null),r.a.createElement("div",{className:"text"},r.a.createElement("div",null,"Creating Your Group"),r.a.createElement("br",null),r.a.createElement(C.a,{className:"form",onSubmit:e.handleSubmit},r.a.createElement(C.a.Group,{controlId:"form.input_users"},r.a.createElement(C.a.Label,null,"Input name(s):"),r.a.createElement(O.a,{multiple:!0,id:"input_users",options:[],freeSolo:!0,required:"Please enter at least one user",onChange:e.handleUsers,value:e.state.input_users,renderInput:function(e){return r.a.createElement(y.a,Object.assign({},e,{variant:"filled",label:"User(s)"}))}})),r.a.createElement(C.a.Group,{className:"form-group",controlId:"form.input_location"},r.a.createElement(C.a.Label,null,"Input location:"),r.a.createElement("br",null),r.a.createElement(y.a,{fullWidth:!0,required:!0,label:"Establishment",name:"input_location",onChange:e.handleChange,value:e.state.input_location,variant:"filled"})),r.a.createElement(C.a.Group,{controlId:"form.input_address"},r.a.createElement(C.a.Label,null,"Address:"),r.a.createElement(F,{handleParentFunc:function(t){e.handleParentFunc(t)}})),r.a.createElement(C.a.Group,{className:"form-group",controlId:"form.select_state"}),r.a.createElement(C.a.Group,{controlId:"form.input_tip"},r.a.createElement(C.a.Label,null,"Input Tip here:"),r.a.createElement(G.a,{fullWidth:!0,variant:"filled"},r.a.createElement(B.a,{htmlFor:"filled-adornment-amount"},"Amount"),r.a.createElement(J.a,{id:"filled-adornment-amount",name:"input_tip",value:e.state.input_tip,onChange:e.handleChange,endAdornment:r.a.createElement(z.a,{position:"end"},"%")})),r.a.createElement(C.a.Control.Feedback,null)),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("input",{type:"file",name:"file",accept:"image/png, image/jpeg",ref:e.inputFileRef,onChange:e.handleImage}),r.a.createElement("br",null),e.state.preview&&r.a.createElement(H.a,{src:e.state.preview,crop:e.state.crop,ruleOfThirds:!0,onImageLoaded:e.onImageLoaded,onComplete:e.onCropComplete,onChange:e.onCropChange})),r.a.createElement("br",null),r.a.createElement(x.a,{type:"submit"}," Submit form "))))}))}}]),a}(n.Component)),q=a(270),K=a(268),$=(a(183),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState({session_link:e.target.value})},n.handleSubmit=function(){if(0===n.state.session_link.length)return alert("Please enter a link");var e=n.state.session_link.search("/split_bill");if(-1===e)return alert("Please enter a valid link");n.state.session_link.substring(e),n.setState({submit_link:n.state.session_link.substring(e,n.state.session_link.length)})},n.state={session_link:"",submit_link:""},n}return Object(o.a)(a,[{key:"render",value:function(){return""!==this.state.submit_link?r.a.createElement(_.a,{to:this.state.submit_link}):r.a.createElement("div",null,r.a.createElement(f,null),r.a.createElement("div",{className:"text"},r.a.createElement("label",{className:"form"},"Enter your invite link:",r.a.createElement("br",null),r.a.createElement(K.a,{type:"text",value:this.state.session_link,onChange:this.handleChange})),r.a.createElement("br",null),r.a.createElement(h.a,{type:"submit",onClick:this.handleSubmit},"Join"),r.a.createElement(q.a,{id:"my-helper-text"},"This will redirect you to your session.")))}}]),a}(n.Component)),M=a(6),Y=a(266),Q=(a(184),a(274)),X=a(277),Z=a(273),ee=a(229),te=a(143),ae=a.n(te),ne=a(221),re=function(e){var t=e.color;return r.a.createElement("hr",{style:{color:t,backgroundColor:t,height:5,margin:5}})},ie=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleChange=function(e){e.preventDefault(),n.setState(Object(k.a)({},e.target.name,e.target.value))},n.fetchGroupData=Object(v.a)(E.a.mark((function e(){var t,a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/get_group/?group_URL=".concat(n.state.group_url));case 3:return t=e.sent,a=t.status,e.next=7,t.json();case 7:r=e.sent,200===a?(r.items.sort((function(e,t){return e.item_name<t.item_name?-1:e.item_name>t.item_name?1:0})),n.setState({city:r.city,image_url:r.image_url,item_assignments:r.item_assignments,user_assignments:r.user_assignments,items:r.items,location_name:r.location_name,state_name:r.state_name,street_address:r.street_address,sub_total:r.sub_total,tax_rate:r.tax_rate,tip_rate:r.tip_rate,total_adjustment:r.total_adjustment,total_cost:r.total_cost,users:r.users,user_count:r.user_count,zip_code:r.zip_code,address:r.street_address+", "+r.city+", "+r.state_name})):a>=400&&n.setState({redirect:!0},(function(){alert(r.error)})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),n.handleAssign=function(){var e=Object(v.a)(E.a.mark((function e(t,a,r,i){var s,l,o,c,u,m,d;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null,l=null,"create-option"!==r){e.next=13;break}return o={nickname:a[a.length-1],item_name:t.target.name,group_url:n.state.group_url},e.next=6,fetch("/api/assign_item",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(o)});case 6:return c=e.sent,s=c.status,e.next=10,c.json();case 10:l=e.sent,e.next=35;break;case 13:if("remove-option"!==r){e.next=34;break}if(u=null,a){e.next=19;break}u=n.state.item_assignments[t.target.name][0],e.next=24;break;case 19:if(t.target.name){e.next=23;break}return e.abrupt("return");case 23:u=n.state.item_assignments[t.target.name].filter((function(e){return!a.includes(e)}));case 24:return m={nickname:u[0],item_name:t.target.name,group_url:n.state.group_url},e.next=27,fetch("/api/unassign_item",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(m)});case 27:return d=e.sent,s=d.status,e.next=31,d.json();case 31:l=e.sent,e.next=35;break;case 34:return e.abrupt("return");case 35:if(200!==s){e.next=41;break}return e.next=38,n.fetchGroupData();case 38:n.state.socket.emit("new_update",n.state.group_url),e.next=42;break;case 41:alert(l.error);case 42:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),n.handleItemEdit=function(){var e=Object(v.a)(E.a.mark((function e(t){var a,r,i,s,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="0.0",n.state.new_item_name!==n.state.item_modal||n.state.new_item_cost!==t){e.next=5;break}return e.abrupt("return",alert("Please enter some change to edit"));case 5:if(0!==n.state.new_item_name.length){e.next=9;break}return e.abrupt("return",alert("Name cannot be empty"));case 9:0!==n.state.new_item_cost.length&&(a=n.state.new_item_cost);case 10:return r={item_name:n.state.item_modal,new_item_name:n.state.new_item_name,new_item_cost:a,group_url:n.state.group_url},e.next=13,fetch("/api/edit_item",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"PUT",body:JSON.stringify(r)});case 13:return i=e.sent,s=i.status,e.next=17,i.json();case 17:if(l=e.sent,200!==s){e.next=25;break}return e.next=21,n.fetchGroupData();case 21:n.setState({item_modal:"",new_item_name:"",new_item_cost:""}),n.state.socket.emit("new_update",n.state.group_url),e.next=26;break;case 25:alert(l.error);case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleUserEdit=function(){var e=Object(v.a)(E.a.mark((function e(t){var a,r,i,s,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="0.0",n.state.new_nickname!==n.state.user_modal||n.state.new_adjusted_amount!==t){e.next=5;break}return e.abrupt("return",alert("Please enter something different to edit"));case 5:if(0!==n.state.new_nickname.length){e.next=9;break}return e.abrupt("return",alert("Username cannot be empty!"));case 9:0!==n.state.new_adjusted_amount&&(a=n.state.new_adjusted_amount);case 10:return r={nickname:n.state.user_modal,new_nickname:n.state.new_nickname,adjusted_amount:a,group_url:n.state.group_url},e.next=13,fetch("/api/edit_user",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"PUT",body:JSON.stringify(r)});case 13:return i=e.sent,s=i.status,e.next=17,i.json();case 17:if(l=e.sent,200!==s){e.next=25;break}return e.next=21,n.fetchGroupData();case 21:n.setState({user_modal:"",new_nickname:"",new_adjusted_amount:""}),n.state.socket.emit("new_update",n.state.group_url),e.next=26;break;case 25:alert(l.error);case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleOpen=function(e,t,a){var r;if("user_modal"===e)n.setState((r={},Object(k.a)(r,e,t),Object(k.a)(r,"new_adjusted_amount",a),Object(k.a)(r,"new_nickname",t),r));else if("item_modal"===e){var i;n.setState((i={},Object(k.a)(i,e,t),Object(k.a)(i,"new_item_cost",a),Object(k.a)(i,"new_item_name",t),i))}else if("add_item"===e||"add_user"===e)n.setState(Object(k.a)({},e,!0));else if("edit_tip"===e){var s;n.setState((s={},Object(k.a)(s,e,!0),Object(k.a)(s,"new_tip_rate",n.state.tip_rate),s))}},n.handleClose=function(e){var t;if("user_modal"===e)n.setState((t={},Object(k.a)(t,e,""),Object(k.a)(t,"new_adjusted_amount",""),Object(k.a)(t,"new_user_name",""),t));else if("item_modal"===e){var a;n.setState((a={},Object(k.a)(a,e,""),Object(k.a)(a,"new_item_cost",""),Object(k.a)(a,"new_item_name",""),a))}else"add_item"!==e&&"add_user"!==e&&"edit_tip"!==e||n.setState(Object(k.a)({},e,!1))},n.handleDeleteItem=Object(v.a)(E.a.mark((function e(){var t,a,r,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={item_name:n.state.item_modal,group_url:n.state.group_url},e.next=3,fetch("/api/delete_item",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"DELETE",body:JSON.stringify(t)});case 3:return a=e.sent,r=a.status,e.next=7,a.json();case 7:if(i=e.sent,200!==r){e.next=15;break}return e.next=11,n.fetchGroupData();case 11:n.setState({item_modal:"",new_item_name:"",new_item_cost:""}),n.state.socket.emit("new_update",n.state.group_url),e.next=16;break;case 15:alert(i.error);case 16:case"end":return e.stop()}}),e)}))),n.handleDeleteUser=Object(v.a)(E.a.mark((function e(){var t,a,r,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={nickname:n.state.user_modal,group_url:n.state.group_url},e.next=3,fetch("/api/delete_user",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"DELETE",body:JSON.stringify(t)});case 3:return a=e.sent,r=a.status,e.next=7,a.json();case 7:if(i=e.sent,200!==r){e.next=15;break}return e.next=11,n.fetchGroupData();case 11:n.setState({user_modal:"",new_adjusted_amount:"",new_user_name:""}),n.state.socket.emit("new_update",n.state.group_url),e.next=16;break;case 15:alert(i.error);case 16:case"end":return e.stop()}}),e)}))),n.handleAddUser=Object(v.a)(E.a.mark((function e(){var t,a,r,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.state.add_user_name.length){e.next=4;break}return e.abrupt("return",alert("User must have name"));case 4:if(0!==n.state.add_user_adjusted_amount.length){e.next=6;break}return e.abrupt("return",alert("User must have some cost"));case 6:return t={nickname:n.state.add_user_name,amount_adjusted:n.state.add_user_adjusted_amount,group_url:n.state.group_url},e.next=9,fetch("/api/create_user",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify(t)});case 9:return a=e.sent,r=a.status,e.next=13,a.json();case 13:if(i=e.sent,200!==r){e.next=21;break}return e.next=17,n.fetchGroupData();case 17:n.setState({add_user:!1,add_user_name:"",add_user_adjusted_amount:""}),n.state.socket.emit("new_update",n.state.group_url),e.next=22;break;case 21:alert(i.error);case 22:case"end":return e.stop()}}),e)}))),n.handleAddItem=Object(v.a)(E.a.mark((function e(){var t,a,r,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.state.add_item_name.length){e.next=4;break}return e.abrupt("return",alert("Item must have name"));case 4:if(0!==n.state.add_item_cost.length){e.next=6;break}return e.abrupt("return",alert("Item must have some cost"));case 6:return t={item_name:n.state.add_item_name,item_cost:n.state.add_item_cost,group_url:n.state.group_url},e.next=9,fetch("/api/create_item",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify(t)});case 9:return a=e.sent,r=a.status,e.next=13,a.json();case 13:if(i=e.sent,200!==r){e.next=21;break}return e.next=17,n.fetchGroupData();case 17:n.setState({add_item:!1,add_item_name:"",add_item_cost:""}),n.state.socket.emit("new_update",n.state.group_url),e.next=22;break;case 21:alert(i.error);case 22:case"end":return e.stop()}}),e)}))),n.handleTip=Object(v.a)(E.a.mark((function e(){var t,a,r,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="0.0",!(n.state.new_tip_rate.length>0&&"-"===n.state.new_tip_rate[0])){e.next=5;break}return e.abrupt("return",alert("Tip cannot be negative"));case 5:if(parseFloat(n.state.new_tip_rate)!==n.state.tip_rate){e.next=9;break}return e.abrupt("return",alert("Please enter a different tip rate"));case 9:0!==n.state.new_tip_rate.length&&(t=parseFloat(n.state.new_tip_rate));case 10:return a={tip_rate:t,group_url:n.state.group_url},e.next=13,fetch("/api/edit_tip_rate",{headers:{"Content-Type":"application/json",Accept:"application/json"},method:"PUT",body:JSON.stringify(a)});case 13:return r=e.sent,i=r.status,e.next=17,r.json();case 17:if(s=e.sent,200!==i){e.next=25;break}return e.next=21,n.fetchGroupData();case 21:n.setState({edit_tip:!1,new_tip_rate:""}),n.state.socket.emit("new_update",n.state.group_url),e.next=26;break;case 25:alert(s.error);case 26:case"end":return e.stop()}}),e)}))),n.handleImage=function(){n.setState({show_image:!n.state.show_image})},n.copyCodeToClipboard=function(){n.textArea.select(),document.execCommand("copy"),n.setState({copySuccess:!0})},n.handleReupload=function(){var e=Object(v.a)(E.a.mark((function e(t){var a,r,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),null!==n.state.file&&0!==n.state.preview.length){e.next=3;break}return e.abrupt("return",alert("Please Choose a New Image to Upload"));case 3:return(a=new FormData).append("file",n.state.newFile),e.next=7,fetch("/api/reupload_image/?group_URL=".concat(n.state.group_url),{method:"POST",body:a});case 7:return r=e.sent,i=r.status,e.next=11,r.json();case 11:if(s=e.sent,200!==i){e.next=19;break}return n.setState({preview:"",show_image:!1}),n.state.socket.emit("new_update",n.state.group_url),e.next=17,n.fetchGroupData();case 17:e.next=22;break;case 19:return console.log(s.error),console.log("This doesn't work"),e.abrupt("return");case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleImagePreview=function(e){if(void 0!==e.target.files[0]){var t=URL.createObjectURL(e.target.files[0]),a=new Blob([e.target.files[0]]);n.setState({file:a,preview:t})}else n.state.preview.length>0&&n.setState({preview:""})},n.onImageLoaded=function(e){n.imageRef=e,n.setState({newFile:n.imageRef})},n.onCropComplete=function(e){n.makeClientCrop(e)},n.onCropChange=function(e){n.setState({crop:e})},n.componentDidMount=Object(v.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchGroupData();case 2:"/socket",t=ae.a.connect("/socket",{reconnection:!0,transports:["websocket"]}),n.setState({socket:t}),t.emit("join",{room:n.state.group_url}),t.on("new_update",(function(){n.fetchGroupData()}));case 7:case"end":return e.stop()}}),e)}))),n.componentWillUnmount=function(){n.state.socket.emit("leave",{room:n.state.group_url})},n.state={city:"",group_url:e.groupURL.match.url,full_url:window.location.href,image_url:"",item_assignments:{},user_assignments:{},items:[],location_name:"",state_name:"",street_address:"",sub_total:0,tax_rate:0,tip_rate:0,total_adjustment:0,total_cost:0,users:[],zip_code:"",redirect:!1,user_count:0,address:"",user_modal:"",new_user_name:"",new_adjusted_amount:"",item_modal:"",new_item_name:"",new_item_cost:"",add_item:!1,add_item_name:"",add_item_cost:"0.0",add_user:!1,add_user_name:"",add_user_adjusted_amount:"0.0",new_tip_rate:"",copySuccess:!1,show_image:!1,socket:"",file:null,preview:"",newFile:"",crop:{unit:"%",width:100,height:100},croppedImageUrl:""},n}return Object(o.a)(a,[{key:"makeClientCrop",value:function(){var e=Object(v.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.imageRef&&t.width&&t.height)){e.next=5;break}return e.next=3,this.getCroppedImg(this.imageRef,t,"newFile.jpeg");case 3:a=e.sent,this.setState({croppedImageUrl:a});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCroppedImg",value:function(e,t,a){var n=this,r=document.createElement("canvas"),i=e.naturalWidth/e.width,s=e.naturalHeight/e.height;return r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(e,t.x*i,t.y*s,t.width*i,t.height*s,0,0,t.width,t.height),new Promise((function(e,t){r.toBlob((function(t){t?(window.URL.revokeObjectURL(n.fileUrl),n.fileUrl=window.URL.createObjectURL(t),e(n.fileUrl),n.setState({newFile:t})):console.error("Canvas is empty")}))}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",null,r.a.createElement(f,null),this.state.redirect?r.a.createElement(_.a,{to:"/"}):r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h4",{style:{textAlign:"center"}}," ",this.state.location_name," "),r.a.createElement("p",{style:{textAlign:"center"}}," ",this.state.address," "),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("textarea",{style:{width:"250px"},ref:function(t){return e.textArea=t},defaultValue:this.state.full_url})),r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("button",{onClick:function(){return e.copyCodeToClipboard()}},"Copy to Clipboard"),this.state.copySuccess?r.a.createElement("div",{style:{color:"green"}},"Success!"):null),r.a.createElement(ne,{value:this.state.full_url}),r.a.createElement(I.a,{container:!0,spacing:3},r.a.createElement(I.a,{item:!0,xs:!0},r.a.createElement(Y.a,{className:t.paper},r.a.createElement("div",{className:"items_flex_container"},r.a.createElement("div",{className:"items_line"}," Items "),r.a.createElement(X.a,{style:{align:"right"},"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:this.state.add_item,onClose:function(){return e.handleClose("add_item")},closeAfterTransition:!0,BackdropComponent:Z.a,BackdropProps:{timeout:500}},r.a.createElement(ee.a,{in:this.state.add_item},r.a.createElement("div",{className:t.paper_modal},r.a.createElement(y.a,{id:"outlined-basic",label:"Item Name",variant:"outlined",name:"add_item_name",placeholder:"name",onChange:this.handleChange}),r.a.createElement(y.a,{id:"outlined-basic",label:"Item Cost",variant:"outlined",name:"add_item_cost",placeholder:"0.00",onChange:this.handleChange,type:"number",step:.01}),r.a.createElement("div",null,r.a.createElement(Q.a,{onClick:this.handleAddItem},"Add"),r.a.createElement(Q.a,{onClick:function(){return e.handleClose("add_item")}},"Cancel"))))),r.a.createElement("div",{className:"add_item_button"},r.a.createElement(Q.a,{variant:"outlined",color:"primary",className:t.item_button,size:"small",display:"inline",onClick:function(){return e.handleOpen("add_item","na","na")}},"Add Item"))),this.state.items.map((function(a,n){return r.a.createElement("div",{key:n+1},r.a.createElement(X.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:e.state.item_modal===a.item_name,onClose:function(){return e.handleClose("item_modal")},closeAfterTransition:!0,BackdropComponent:Z.a,BackdropProps:{timeout:500}},r.a.createElement(ee.a,{in:e.state.item_modal===a.item_name},r.a.createElement("div",{className:t.paper_modal},r.a.createElement(y.a,{id:"outlined-basic",label:"Change Item Name",variant:"outlined",name:"new_item_name",defaultValue:e.state.new_item_name,onChange:e.handleChange}),r.a.createElement(y.a,{id:"outlined-basic",label:"Change Cost",variant:"outlined",name:"new_item_cost",defaultValue:e.state.new_item_cost,onChange:e.handleChange,type:"number",step:.01}),r.a.createElement("div",null,r.a.createElement(Q.a,{onClick:e.handleDeleteItem},"Delete"),r.a.createElement(Q.a,{onClick:function(){return e.handleItemEdit(a.item_cost)}},"Edit"),r.a.createElement(Q.a,{onClick:function(){return e.handleClose("item_modal")}},"Cancel"))))),r.a.createElement(Q.a,{variant:"outlined",color:"primary",className:t.item_button,onClick:function(){return e.handleOpen("item_modal",a.item_name,a.item_cost)},size:"small",display:"inline"},a.item_name,": $",a.item_cost),r.a.createElement(O.a,{id:"free-solo-demo",freeSolo:!0,display:"inline",disableClearable:!0,disableCloseOnSelect:!0,value:e.state.item_assignments[a.item_name],multiple:!0,options:[],onChange:e.handleAssign,size:"small",name:a.item_name,renderInput:function(e){return r.a.createElement(y.a,Object.assign({},e,{label:"user(s)",margin:"normal",variant:"outlined",name:a.item_name}))}}))}))))),r.a.createElement("br",null),r.a.createElement(re,{color:"black"}),r.a.createElement("br",null),r.a.createElement(I.a,{container:!0,spacing:3},r.a.createElement(X.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:this.state.add_user,onClose:function(){return e.handleClose("add_user")},closeAfterTransition:!0,BackdropComponent:Z.a,BackdropProps:{timeout:500}},r.a.createElement(ee.a,{in:this.state.add_user},r.a.createElement("div",{className:t.paper_modal},r.a.createElement(y.a,{id:"outlined-basic",label:"Username",variant:"outlined",name:"add_user_name",placeholder:"name",onChange:this.handleChange}),r.a.createElement(y.a,{id:"outlined-basic",label:"Adjusted Amount",variant:"outlined",name:"add_user_adjusted_amount",placeholder:"0.00",onChange:this.handleChange,type:"number",step:.01}),r.a.createElement("div",null,r.a.createElement(Q.a,{onClick:this.handleAddUser},"Add"),r.a.createElement(Q.a,{onClick:function(){return e.handleClose("add_user")}},"Cancel"))))),r.a.createElement("div",{className:"add_user_button"},r.a.createElement(Q.a,{variant:"outlined",color:"primary",className:t.item_button,size:"small",display:"inline",onClick:function(){return e.handleOpen("add_user","na","na")}},"Add User")),this.state.users.map((function(a,n){return r.a.createElement(I.a,{item:!0,xs:!0,key:n+1},r.a.createElement(X.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:e.state.user_modal===a.user_nickname,onClose:function(){return e.handleClose("user_modal")},closeAfterTransition:!0,BackdropComponent:Z.a,BackdropProps:{timeout:500}},r.a.createElement(ee.a,{in:e.state.user_modal===a.user_nickname},r.a.createElement("div",{className:t.paper_modal},r.a.createElement(y.a,{id:"outlined-basic",label:"Change User Name",variant:"outlined",name:"new_nickname",defaultValue:e.state.new_nickname,onChange:e.handleChange}),r.a.createElement(y.a,{id:"outlined-basic",label:"Change Adjustment",variant:"outlined",name:"new_adjusted_amount",defaultValue:e.state.new_adjusted_amount,onChange:e.handleChange,type:"number",step:.01}),r.a.createElement("div",null,r.a.createElement(Q.a,{onClick:e.handleDeleteUser},"Delete"),r.a.createElement(Q.a,{onClick:function(){return e.handleUserEdit(a.user_adjusted_amount)}},"Edit"),r.a.createElement(Q.a,{onClick:function(){return e.handleClose("user_modal")}},"Cancel"))))),r.a.createElement(Y.a,{className:t.paper},r.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},r.a.createElement(Q.a,{onClick:function(){return e.handleOpen("user_modal",a.user_nickname,a.user_adjusted_amount)}},a.user_nickname)),r.a.createElement("div",{className:"innerList"},void 0===e.state.user_assignments?r.a.createElement("div",{style:{textAlign:"center"}},"no assignments"):0===e.state.user_assignments[a.user_nickname].length?r.a.createElement("div",null,r.a.createElement("div",{style:{textAlign:"center"}}," no assignments "),r.a.createElement("div",{style:{textAlign:"center"}}," adjustments: ",a.user_adjusted_amount.toFixed(2)," ")):r.a.createElement("div",{style:{textAlign:"center"}},e.state.user_assignments[a.user_nickname].map((function(e,t){return r.a.createElement("div",{key:t+1,style:{textAlign:"center"}},e)})),r.a.createElement("br",null),r.a.createElement("div",null,"total: ",a.user_amount_owed.toFixed(2),r.a.createElement("br",null),"adjustments: ",a.user_adjusted_amount.toFixed(2))))))}))),r.a.createElement(I.a,{container:!0,spacing:3},r.a.createElement(I.a,{item:!0,xs:!0},r.a.createElement(Y.a,{className:t.paper},this.state.edit_tip?r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(y.a,{id:"outlined-basic",label:"Tip",variant:"outlined",name:"new_tip_rate",onChange:this.handleChange,defaultValue:this.state.new_tip_rate,type:"number"}),r.a.createElement(Q.a,{onClick:this.handleTip},"Submit"),r.a.createElement(Q.a,{onClick:function(){return e.handleClose("edit_tip")}},"Cancel")):r.a.createElement("div",{className:"edit_flex_container"},r.a.createElement("div",null,"Tip Rate: ",this.state.tip_rate,"%"),r.a.createElement(Q.a,{variant:"outlined",color:"primary",className:t.item_button,size:"small",display:"inline",onClick:function(){return e.handleOpen("edit_tip")}},"Edit Tip")),r.a.createElement("div",{style:{textAlign:"center"}},"Tax Rate: ",0===this.state.tax_rate?0:100*(this.state.tax_rate-1).toFixed(6),"% "),r.a.createElement("div",{style:{textAlign:"center"}},"SubTotal: $",this.state.sub_total.toFixed(2)),r.a.createElement("div",{style:{textAlign:"center"}},"Grand Total: $",this.state.total_cost.toFixed(2)),r.a.createElement("div",{style:{textAlign:"center"}},"Net Adjustments: $",this.state.total_adjustment.toFixed(2)),this.state.image_url.length>0?this.state.show_image?r.a.createElement("div",null,r.a.createElement(Q.a,{onClick:this.handleImage},"Hide"),r.a.createElement("img",{style:{width:225},src:this.state.image_url,alt:"None"})):r.a.createElement(Q.a,{onClick:this.handleImage},"Show"):r.a.createElement("p",null,"No Receipt Uploaded"),r.a.createElement(C.a,{className:"form",onSubmit:this.handleReupload},r.a.createElement("div",null,r.a.createElement("input",{type:"file",name:"file",accept:"image/png, image/jpeg",onChange:this.handleImagePreview}),r.a.createElement("br",null),this.state.preview&&r.a.createElement(H.a,{src:this.state.preview,crop:this.state.crop,ruleOfThirds:!0,onImageLoaded:this.onImageLoaded,onComplete:this.onCropComplete,onChange:this.onCropChange})),r.a.createElement(Q.a,{type:"submit"},"New Upload"))))),r.a.createElement("br",null)))}}]),a}(n.Component),se=Object(M.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),color:e.palette.text.secondary,margin:"1%"},fullWidth:{width:"100%"},item_button:{margin:"0.1em"},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper_modal:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}),{withTheme:!0})(ie);var le=function(){var e=function(){return r.a.createElement(g,null)};return r.a.createElement("div",{className:"App"},r.a.createElement(_.d,null,r.a.createElement(_.b,{exact:!0,path:"/",render:e}),r.a.createElement(_.b,{exact:!0,path:"/create_group",component:function(){return r.a.createElement(V,null)}}),r.a.createElement(_.b,{exact:!0,path:"/join_group",component:function(){return r.a.createElement($,null)}}),r.a.createElement(_.b,{exact:!0,path:"/split_bill",component:e}),r.a.createElement(_.b,{path:"/split_bill/:groupURL",component:function(e){return r.a.createElement(se,{groupURL:e})}})))},oe=a(47);s.a.render(r.a.createElement(oe.a,null,r.a.createElement(le,null)),document.getElementById("root"))}},[[227,1,2]]]);
//# sourceMappingURL=main.62ec9b28.chunk.js.map